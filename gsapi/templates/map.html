{% extends 'base.html' %}
{% block title %}map of all ground stations{% endblock %}

{% block bootstrap4_extra_head %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

        <style>
                html, body {
                        height: 100%;
                        margin: 0;
                }
                #map {
                        width: 100%;
                        height: 800px;
                }
        </style>

{% endblock %}


{% block content %}
<div id='map'></div>

<script type="text/javascript">
  /* replace with data in /api/v1/nodes/coordinates/ */
  var station = {
  "type": "FeatureCollection",
  "features": [
  {
  "geometry": {
  "type": "Point",
  "coordinates": [
  7.624722,
  52.485833,
  40.0
  ]
  },
  "type": "Feature",
  "properties": {
  "name": "Settrup Station",
  "url": "",
  "popupContent": "Settrup Station"
  },
  "id": 1
}]}
</script>

<script>
        var map = L.map('map').setView([50.0, 0.0], 3);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                maxZoom: 18,
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                        '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                        'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                id: 'mapbox.light'
        }).addTo(map);


        function onEachFeature(feature, layer) {
                var popupContent = "<p>I am a ground station.</p>";

                if (feature.properties && feature.properties.popupContent) {
                        popupContent += feature.properties.popupContent;
                }
                popupContent += "<br>";
                if (feature.properties && feature.properties.url) {
                        popupContent += feature.properties.url;
                }

                layer.bindPopup(popupContent);
        }

        L.geoJSON([station], {

                style: function (feature) {
                        return feature.properties && feature.properties.style;
                },

                pointToLayer: function (feature, latlng) {
                        return L.marker(latlng);
                },

                onEachFeature: onEachFeature
        }).addTo(map);
</script>

{% endblock %}
